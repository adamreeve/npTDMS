box: adreeve/python-numpy

build:
  steps:
    - script:
        name: PEP8 Check
        code: |
           pep8 ./nptdms
    - script:
        name: Test on Python 2.7
        code: |
          pip install pytest==4.6.9
          pip install .[test,hdf,pandas,thermocouple_scaling]
          python -m pytest
    - script:
        name: Test on Python 3
        code: |
          export LC_ALL=C.UTF-8
          pip3 install .[test,hdf,pandas,thermocouple_scaling]
          python3 -m pytest

deploy:
  steps:
    - script:
        name: Deploy to pypi
        code: |
          echo "[distutils]
          index-servers =
              pypi

          [pypi]
          username:$PYPI_USER
          password:$PYPI_PASSWORD" > ~/.pypirc
          python setup.py sdist upload || exit 1
          python setup.py bdist_wheel upload || exit 1
